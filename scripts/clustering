# -*- coding: utf-8 -*-
"""clustering.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1QUxOw1IM4JmNOcLuTmxrh7EFRsqenisK
"""

import scanpy as sc

def run_embedding_and_clustering(infile, outfile, n_pcs=40, n_neighbors=10, resolution=1.0):
    adata = sc.read_h5ad(infile)
    sc.tl.pca(adata, svd_solver='arpack', n_comps=n_pcs)
    sc.pp.neighbors(adata, n_neighbors=n_neighbors, n_pcs=n_pcs)
    sc.tl.umap(adata, min_dist=0.5)
    sc.tl.leiden(adata, resolution=resolution, key_added='leiden')
    adata.write_h5ad(outfile)
